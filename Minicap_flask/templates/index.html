<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript" src="//cdn.bootcss.com/socket.io/1.5.1/socket.io.min.js"></script>
</head>
<body>
<canvas id="canvas" style="border: 1px solid red;"></canvas>
<script>
    $(document).ready(function () {
        var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);
        socket.on('connect', function () {
            socket.emit('my event', {data: 'I\'m connected!'});
        });
        socket.on('server_response', function (data) {
            socket.binaryType = 'blob';
            var BLANK_IMG =
                'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='
            var canvas = document.getElementById('canvas')
                , g = canvas.getContext('2d')
            var blob = new Blob(data.data, {type: 'image/jpeg'})
            var URL = window.URL || window.webkitURL
            var img = new Image()
            img.onload = function () {
                console.log(img.width, img.height)
                canvas.width = img.width
                canvas.height = img.height
                g.drawImage(img, 0, 0)
                img.onload = null
                img.src = BLANK_IMG
                img = null
                u = null
                blob = null
            }
            var u = URL.createObjectURL(blob)
            img.src = u
        });
    });

</script>
</body>
</html>
